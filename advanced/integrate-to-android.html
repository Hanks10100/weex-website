<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Integrate to Android | Weex</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Integrate to AndroidWhen you need to use the new features or to customize specific features, you can rely on the Source SDK for development。
PrerequisitesAssuming you have the Android SDK installed, r">
<meta property="og:type" content="website">
<meta property="og:title" content="Integrate to Android">
<meta property="og:url" content="http://alibaba.github.io/advanced/integrate-to-android.html">
<meta property="og:site_name" content="Weex">
<meta property="og:description" content="Integrate to AndroidWhen you need to use the new features or to customize specific features, you can rely on the Source SDK for development。
PrerequisitesAssuming you have the Android SDK installed, r">
<meta property="og:updated_time" content="2016-12-22T12:27:25.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Integrate to Android">
<meta name="twitter:description" content="Integrate to AndroidWhen you need to use the new features or to customize specific features, you can rely on the Source SDK for development。
PrerequisitesAssuming you have the Android SDK installed, r">
  
    <link rel="alternate" href="/atom.xml" title="Weex" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/weex-website/css/style.css">
  <link rel="stylesheet" href="/weex-website/css/swiper.min.css">
  

</head>

<body id="advanced" class="lang-en">
  
  <header id="header">
  <div class="navbar">
    <a id="logo" href="/weex-website/">
      <img src="/weex-website/images/logo.png" />
    </a>
    <div class="main-nav">
      <ul class="links">
        <li><a href="/weex-website/guide">Guide</a></li>
        <li><a href="/weex-website/references">References</a></li>
        <li><a href="/weex-website/faq.html">FAQ</a></li>
        <li class="dropdown">
            <a href="javascript:;">Resources</a>
            <ul class="dropdown-menu subnav">
              <li>
                <a href="/weex-website/playground.html">Playground</a>
              </li>
              <li>
                <a href="/weex-website/tools">Tools</a>
              </li>
              <li>
                <a href="/weex-website/advanced">Advanced</a>
              </li>
              <li>
                <a href="https://www.npmjs.com/package/weex-devtool" target="_blank">Devtool</a>
              </li>
            </ul>
        </li>
      </ul>
      <ul class="info">
        <li><a href="https://github.com/alibaba/weex/" target="_blank"><span class="btn-github iconfont icon-github"></span></a></li>
      </ul>
      <ul class="tools">
        <li><a class="btn-search"><span class="iconfont icon-search"></span></a></li>
        <!--<li></li>-->
      </ul>
    </div>
  </div>
  <div id="mobile-nav">
    <a id="logo" href="/">
      <img src="/weex-website/images/logo.png" />
    </a>
    <a class="btn-menu"><span class="iconfont icon-nav"></span></a>
  </div>
</header>
  <div id="sidebar" class="">
  <div class="sidebar-menu">
    
      <ul class="main-nav">
        <li>
          <a class="" href="/weex-website/guide">
            Guide
          </a>
        </li>
        <li>
          <a class="" href="/weex-website/references">
            References
          </a>
        </li>
        <li>
          <a href="/weex-website/faq">
            FAQ
          </a>
        </li>
        <li>
            <p>Resources</p>
            <ul class="subnav">
              <li>
                <a href="./playground.html">Playground</a>
              </li>
              <li>
                <a href="/weex-website/tools">Tools</a>
              </li>
              <li>
                <a href="/weex-website/advanced">Advanced</a>
              </li>
              <li>
                <a href="https://www.npmjs.com/package/weex-devtool" target="_blank">Devtool</a>
              </li>
            </ul>
        </li>
        <li>
          <a href="https://github.com/alibaba/weex" target="_blank">
            Github
          </a>
        </li>
      </ul>
    
    <a class="btn-close-sidebar iconfont  icon-close"></a>
  </div>
</div>
  <div class="article-wrapper page-layout">
  <div class="doc-nav">
    <div class="summary">
  <h2 class="part-title">
    
      Advanced
    
  </h2>
  <ul class="doc-summary">
    
    
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
   
    
      <li>
        <h3 class="chapter-title"><a href="/weex-website/advanced/index.html" class="sidebar-link  ">How it works</a></h3>
        
      </li>
    
      <li>
        <h3 class="chapter-title"><a href="/weex-website/advanced/how-data-binding-works.html" class="sidebar-link  ">How data-binding works</a></h3>
        
      </li>
    
      <li>
        <h3 class="chapter-title"><a href="/weex-website/advanced/integrate-to-android.html" class="sidebar-link current ">Integrate to Android</a></h3>
        
      </li>
    
      <li>
        <h3 class="chapter-title"><a href="/weex-website/advanced/integrate-to-ios.html" class="sidebar-link  ">Integrate to iOS</a></h3>
        
      </li>
    
      <li>
        <h3 class="chapter-title"><a href="/weex-website/advanced/integrate-to-html5.html" class="sidebar-link  ">Integrate to web</a></h3>
        
      </li>
    
      <li>
        <h3 class="chapter-title"><a href="/weex-website/advanced/extend-to-android.html" class="sidebar-link  ">Extend to Android</a></h3>
        
      </li>
    
      <li>
        <h3 class="chapter-title"><a href="/weex-website/advanced/extend-to-ios.html" class="sidebar-link  ">Extend to iOS</a></h3>
        
      </li>
    
      <li>
        <h3 class="chapter-title"><a href="/weex-website/advanced/extend-to-html5.html" class="sidebar-link  ">Extend to web</a></h3>
        
      </li>
    
  </ul>
</div>
  </div>
  

<article id="page-undefined" class="article article-type-advanced">
  <div class="article-entry" itemprop="articleBody">
    <header class="article-header">
  
    
      <h1 class="article-title" itemprop="name">
        Integrate to Android
      </h1>
    
  
  <time class="article-date" datetime="2016-12-22T12:27:25.000Z">Updated time: 22/12/2016</time>
</header>
    <h1 id="Integrate-to-Android"><a href="#Integrate-to-Android" class="headerlink" title="Integrate to Android"></a>Integrate to Android</h1><p>When you need to use the new features or to customize specific features, you can rely on the Source SDK for development。</p>
<h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><p>Assuming you have the Android SDK installed, run <code>android</code> to open the Android SDK Manager.</p>
<p>Make sure you have the following installed:</p>
<ol>
<li>Android SDK version 23 (compileSdkVersion in <a href="https://github.com/alibaba/weex/blob/master/android/sdk/build.gradle" target="_blank" rel="external"><code>build.gradle</code></a>)</li>
<li>SDK build tools version 23.0.2 (buildToolsVersion in <a href="https://github.com/alibaba/weex/blob/master/android/sdk/build.gradle" target="_blank" rel="external"><code>build.gradle</code></a>)</li>
<li>Android Support Repository &gt;= 17 (for Android Support Library)</li>
<li>Android NDK (download &amp; extraction instructions <a href="http://developer.android.com/ndk/downloads/index.html" target="_blank" rel="external">here</a>)</li>
</ol>
<p>Point Gradle to your Android SDK: either have <code>$ANDROID_SDK</code> and <code>$ANDROID_NDK</code> defined, or create a local.properties file in the root of your weex checkout with the following contents:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">sdk.dir=absolute_path_to_android_sdk</div><div class="line">ndk.dir=absolute_path_to_android_ndk</div></pre></td></tr></table></figure>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">sdk.dir=/Users/your_name/android-sdk-macosx</div><div class="line">ndk.dir=/Users/your_name/android-ndk-r10e</div></pre></td></tr></table></figure>
<h2 id="Building-the-source"><a href="#Building-the-source" class="headerlink" title="Building the source"></a>Building the source</h2><h4 id="1-Clone-source-from-github"><a href="#1-Clone-source-from-github" class="headerlink" title="1. Clone source from github"></a>1. Clone source from github</h4><p>First, you need to git clone <code>weex</code> from github:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">git clone https://github.com/alibaba/weex.git</div></pre></td></tr></table></figure>
<h5 id="2-Build-APK"><a href="#2-Build-APK" class="headerlink" title="2. Build APK"></a>2. Build APK</h5><p>  <strong><em>   1) Android studio build APK </em></strong></p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">Step 1: run android studio </div><div class="line">Step 2: open the file of ~/weex/android/playground/build.gradle </div><div class="line">Step 3: Run the Project and the Apk will auto install in your android device</div></pre></td></tr></table></figure>
<p> <strong><em>   2) Gradle build APK </em></strong></p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">Step 1: enter the direction of &quot;/weex/android/playground&quot;</div><div class="line">Step 2: run the build command: ./gradlew clean assemble</div><div class="line">Step 3: obtain the payground APK from the direction of weex/android/playground/app/build/outputs/apk/</div><div class="line">Step 3: then adb install -r weex/android/playground/app/build/outputs/apk/playgroud.apk</div></pre></td></tr></table></figure>
<h4 id="3-Adding-the-weex-sdk-android-project"><a href="#3-Adding-the-weex-sdk-android-project" class="headerlink" title="3. Adding the :weex_sdk_android project"></a>3. Adding the <code>:weex_sdk_android</code> project</h4><p>Add the <code>:weex_sdk_android</code> project in <code>android/settings.gradle</code>:</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><div class="line"><span class="keyword">include</span> <span class="string">':weex_sdk_android'</span></div><div class="line"></div><div class="line"><span class="keyword">project</span>(<span class="string">':weex_sdk_android'</span>).projectDir = <span class="keyword">new</span> <span class="keyword">File</span>(</div><div class="line">    rootProject.projectDir, <span class="string">'../weex_sdk_android'</span>)</div></pre></td></tr></table></figure>
<p>Modify your <code>android/app/build.gradle</code> to use the <code>:weex_sdk_android</code> project instead of the pre-compiled library, e.g. - replace <code>compile &#39;com.taobao.android:weex_sdk:0.4.1</code> with <code>compile project(&#39;:weex_sdk_android&#39;)</code>:</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><div class="line"><span class="keyword">dependencies</span> &#123;</div><div class="line">    <span class="keyword">compile</span> <span class="keyword">fileTree</span>(dir: <span class="string">'libs'</span>, <span class="keyword">include</span>: [<span class="string">'*.jar'</span>])</div><div class="line">    <span class="keyword">compile</span> <span class="string">'com.android.support:appcompat-v7:23.0.1'</span></div><div class="line"></div><div class="line">    <span class="keyword">compile</span> <span class="keyword">project</span>(<span class="string">':weex_sdk_android'</span>)</div><div class="line"></div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="3-Making-3rd-party-modules-use-your-project"><a href="#3-Making-3rd-party-modules-use-your-project" class="headerlink" title="3. Making 3rd-party modules use your project"></a>3. Making 3rd-party modules use your project</h4><p>If you use 3rd-party weex modules, you need to override their dependencies so that they don’t build the pre-compiled library. Otherwise you’ll get an error while compiling - <code>Error: more than one library with package name &#39;com.taobao.weex&#39;</code>.</p>
<p>Modify your <code>android/app/build.gradle</code> and replace <code>compile project(&#39;:weex-custom-module&#39;)</code> with:</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><div class="line"><span class="keyword">compile</span>(<span class="keyword">project</span>(<span class="string">':weex-custom-module'</span>)) &#123;</div><div class="line">    <span class="keyword">exclude</span> <span class="keyword">group</span>: <span class="string">'com.taobao.weex'</span>, module: <span class="string">'weex_sdk_android'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="4、How-to-load-local-Your-Js-bundle-in-the-directory-of-Android-assets"><a href="#4、How-to-load-local-Your-Js-bundle-in-the-directory-of-Android-assets" class="headerlink" title="4、How to load local Your Js bundle in the directory of Android assets"></a>4、How to load local Your Js bundle in the directory of Android assets</h4><p>Besides load a Js Bundle online, you also can load the js bundle from the directory of Android assets.</p>
<p>For Example:</p>
   <figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">String yourbundleStr =  WXFileUtils.loadFileContent(&quot;yourBundle.js&quot;, context);</div><div class="line">WXSDKInstance.render(TAG, yourbundleStr, options, null, width, Height, WXRenderStrategy.APPEND_ASYNC);</div></pre></td></tr></table></figure>
<h2 id="Building-from-Android-Studio"><a href="#Building-from-Android-Studio" class="headerlink" title="Building from Android Studio"></a>Building from Android Studio</h2><p>From the Welcome screen of Android Studio choose “Import project” and select the <code>playground</code> folder of your app.</p>
<p>You should be able to use the <em>Run</em> button to run your app on a device. </p>
<h2 id="Tip"><a href="#Tip" class="headerlink" title="Tip"></a>Tip</h2><ol>
<li><p>Since the packet size limit is currently only compiled arm , X86 does not support.</p>
</li>
<li><p>Gradle build fails in <code>ndk-build</code>. See the section about <code>local.properties</code> file above.</p>
</li>
</ol>
<p>#Quick access</p>
<h2 id="Requirements"><a href="#Requirements" class="headerlink" title="Requirements"></a>Requirements</h2><ul>
<li>an existing, gradle-based Android app</li>
</ul>
<h2 id="Prepare-your-app"><a href="#Prepare-your-app" class="headerlink" title="Prepare your app"></a>Prepare your app</h2><p>In your app’s <code>build.gradle</code> file add the WEEX dependency:</p>
<pre><code>compile &apos;com.taobao.android:weex_sdk:0.4.1&apos;
</code></pre><p>You can find the latest version of the WEEX library on <a href="https://bintray.com/search?query=weex_sdk&amp;forceAgnostic=true" target="_blank" rel="external">jcenter</a>. Next, make sure you have the Internet permission in your <code>AndroidManifest.xml</code>:</p>
<pre><code>&lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;
</code></pre><h2 id="Add-native-code"><a href="#Add-native-code" class="headerlink" title="Add native code"></a>Add native code</h2><p>You need to add some native code in order to start the Weex runtime and get it to render something. To do this, we’re going to create an <code>Application</code> to init weex, then we we’re going to create an <code>Activity</code> that creates a WeexContainerView, starts a Weex application inside it and sets it as the main content view.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WXApplication</span> <span class="keyword">extends</span> <span class="title">Application</span> </span>&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate();</div><div class="line"></div><div class="line">        WXEnvironment.addCustomOptions(<span class="string">"appName"</span>,<span class="string">"TBSample"</span>);</div><div class="line">        WXSDKEngine.init(<span class="keyword">this</span>);</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line"></div><div class="line">            WXSDKEngine.registerComponent(<span class="string">"wtRichText"</span>, WTRichText.class);</div><div class="line">            ......</div><div class="line">            </div><div class="line">            WXSDKEngine.registerModule(<span class="string">"event"</span>, WXEventModule.class);</div><div class="line">        &#125; <span class="keyword">catch</span> (WXException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Next, </p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="comment">//crate Weex instance</span></div><div class="line">WXSDKInstance mInstance = <span class="keyword">new</span> WXSDKInstance(<span class="keyword">this</span>);</div><div class="line"><span class="comment">//set image Adapter</span></div><div class="line">mInstance.setImgLoaderAdapter(<span class="keyword">new</span> ImageAdapter(<span class="keyword">this</span>));</div><div class="line"><span class="comment">//register render listener</span></div><div class="line">mInstance.registerRenderListener(<span class="keyword">new</span> IWXRenderListener() &#123;</div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onViewCreated</span><span class="params">(WXSDKInstance instance, View view)</span> </span>&#123;</div><div class="line">       <span class="comment">// addview</span></div><div class="line">       mViewGroup.addView(view);</div><div class="line">   &#125; </div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRenderSuccess</span><span class="params">(WXSDKInstance instance)</span> </span>&#123;</div><div class="line">   &#125;</div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRefreshSuccess</span><span class="params">(WXSDKInstance instance)</span> </span>&#123;</div><div class="line">   &#125;</div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onException</span><span class="params">(WXSDKInstance instance, String errCode,String msg)</span> </span>&#123;</div><div class="line">   &#125;</div><div class="line">&#125;); </div><div class="line"><span class="comment">//start render weex view   </span></div><div class="line">mInstance.render(pageName,template, <span class="keyword">null</span>, <span class="keyword">null</span>, -<span class="number">1</span>, -<span class="number">1</span>, WXRenderStrategy.APPEND_ASYNC);</div></pre></td></tr></table></figure>
<p>That’s it, your activity is ready to run some JavaScript code.</p>
<h2 id="Reference-Example"><a href="#Reference-Example" class="headerlink" title="Reference Example"></a>Reference Example</h2><p><a href="https://github.com/alibaba/weex/tree/master/examples" target="_blank" rel="external"><code>Weex Examples</code></a></p>

  </div>
  
</article>
</div>
  <script>window.PAGE_TYPE = "advanced"</script>
  <footer id="footer">
  <div class="row clearfix">
    <div class="ali-logo">
      <img src="/weex-website/images/ali-open-source.png" alt="Alibaba">
    </div>
    <div class="dropdown select-lang">
      <a href="javascript:;" class="dropdown-toggle">
        Language
        <span class="caret"></span>
      </a>
      <ul class="dropdown-menu">
        <li>
          <a href="/weex-website/advanced/integrate-to-android.html">English</a>
        </li>
        <li>
          <a href="/weex-website/cn/advanced/integrate-to-android.html">中文</a>
        </li>
      </ul>
    </div>
  </div>
  <div class="row">
    <p><span>Released under </span><a href="">Apache License 2.0</a></p>
  </div>
  <div class="row clearfix">
    <div class="cell"><span>Copyright(c) 2016 </span><a href="https://www.alibaba.com">Alibaba</a></div>
    <div class="cell"><span>GroupMade by </span><a href="">阿里云UED AX</a></div>
    <div class="cell"><span>Proudly Produced by </span><a href="https://baichuan.taobao.com/">Alibaichuan</a> <span class="iconfont icon-baichuan"></span></div>
  </div>
</footer>
  

<!--<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>-->


  <script src="/weex-website/js/velocity.js"></script>
  <script src="/weex-website/js/common.js"></script>
</body>
</html>
